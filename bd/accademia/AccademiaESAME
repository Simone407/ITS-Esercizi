 --------------------------------------------------------------------
1. . Elencare tutti i progetti la cui fine è successiva al 2023-12-31. 

select *
from progetto
where fine > '2023-12-31'

----------------------------------------------------------------------
2.  Contare il numero totale di persone per ciascuna posizione (Ricercatore, Professore Associato, Professore Ordinario).

select posizione, COUNT(*) AS numero
from persona
group by posizione;

--------------------------------------------------------------------
3.Restituire gli id e i nomi delle persone che hanno almeno un giorno di assenza per "Malattia". 

select distinct a.persona, p.nome, p.cognome
from assenza a 
join persona p on a.persona  =p.id
where a.tipo= 'Malattia';

-----------------------------------------------------------------
4.. Per ogni tipo di assenza, restituire il numero complessivo di occorrenze. 

select tipo, count(*) as numero
from assenza
group by tipo
order by numero;

-------------------------------------------------------------------
5. Calcolare lo stipendio massimo tra tutti i "Professori Ordinari"

select max(stipendio) as stipendio
from persona
where posizione = 'Professore Ordinario';

----------------------------------------------------------------------

6.

-----------------------------------------------------------------------
7. Quanti sono i giorni di assenza per tipo e per persona. Per ogni persona e tipo di assenza, restituire nome, cognome, tipo assenza e giorni totali.

select p.nome, p.cognome, a.tipo, COUNT(a.giorno) as numero
from assenza a
join persona p ON a.persona = p.id
group by p.nome, p.cognome, a.tipo;


---------------------------------------------------------------
8. Restituire tutti i “Professori Ordinari” che hanno lo
stipendio massimo. Per ognuno, restituire id, nome e cognome


SELECT id, nome, cognome, stipendio
FROM persona
WHERE posizione = 'Professore Ordinario'
  AND stipendio = (
      SELECT MAX(stipendio)
      FROM persona
      WHERE posizione = 'Professore Ordinario'
      GROUP BY posizione
  );

-----------------------------------------------------------------

9.

------------------------------------------------------------------

10.

--------------------------------------------------------------------
